<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cha's Monkey Mania</title>
    <style>
        body { margin: 0; background: #87CEEB; font-family: sans-serif; overflow: hidden; touch-action: none; }
        canvas { display: block; background: #90EE90; }
        
        /* Layer Menu Utama */
        #ui {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); display: flex; flex-direction: column;
            align-items: center; justify-content: center; z-index: 10000;
        }
        
        /* Tombol Paling Simple & Pasti Bisa Diklik */
        #gaskeun {
            background: #FF4500; color: white; padding: 25px 60px;
            font-size: 30px; font-weight: bold; border-radius: 20px;
            border: 4px solid white; cursor: pointer; text-align: center;
        }

        #score-board {
            position: fixed; top: 20px; width: 100%; text-align: center;
            color: white; font-size: 40px; font-weight: bold; z-index: 500;
            pointer-events: none; text-shadow: 2px 2px 4px #000;
        }
    </style>
</head>
<body>

    <div id="score-board">0</div>

    <div id="ui">
        <h1 style="color:white; margin-bottom: 20px;">Cha's Monkey Mania</h1>
        <div id="gaskeun" onclick="mulaiSekarang()">GASKEUN!</div>
    </div>

    <canvas id="gc"></canvas>

    <script>
        const cvs = document.getElementById("gc");
        const ctx = cvs.getContext("2d");
        const ui = document.getElementById("ui");
        const scoreTxt = document.getElementById("score-board");

        cvs.width = window.innerWidth;
        cvs.height = window.innerHeight;

        let score = 0, aktif = false, items = [], fever = false;
        let mon = { x: cvs.width/2-40, y: cvs.height-120 };
        let timer, frame;

        // FUNGSI INI HARUS JALAN PAS DIKLIK
        function mulaiSekarang() {
            // Sembunyikan UI
            ui.style.setProperty('display', 'none', 'important');
            
            // Reset Game
            score = 0;
            items = [];
            aktif = true;
            scoreTxt.innerText = "0";
            
            // Bersihkan sisa loop
            clearTimeout(timer);
            cancelAnimationFrame(frame);
            
            // Jalankan
            loop();
            spawn();
            console.log("Game Dimulai!");
        }

        function spawn() {
            if(!aktif) return;
            let jenis = Math.random() < 0.2 ? "ðŸ’£" : "ðŸŒ";
            if(score > 0 && score % 10 === 0) jenis = "âœ¨"; // Golden tiap 10 skor

            items.push({
                x: Math.random() * (cvs.width - 50),
                y: -50,
                t: jenis,
                s: 5 + (score * 0.2)
            });
            timer = setTimeout(spawn, 800 - Math.min(score * 10, 500));
        }

        function loop() {
            if(!aktif) return;
            ctx.clearRect(0,0,cvs.width, cvs.height);

            // Gambar Monkey
            ctx.font = "70px Arial";
            ctx.fillText("ðŸ’", mon.x, mon.y + 70);

            for(let i=items.length-1; i>=0; i--) {
                let it = items[i];
                it.y += it.s;
                ctx.font = "50px Arial";
                ctx.fillText(it.t, it.x, it.y);

                // Cek Tabrakan
                if(it.y > mon.y && it.y < mon.y + 80 && it.x > mon.x - 30 && it.x < mon.x + 60) {
                    if(it.t === "ðŸ’£") {
                        kalah();
                    } else {
                        score += (it.t === "âœ¨" ? 10 : 1);
                        scoreTxt.innerText = score;
                        items.splice(i, 1);
                    }
                } else if(it.y > cvs.height) {
                    items.splice(i, 1);
                }
            }
            frame = requestAnimationFrame(loop);
        }

        function kalah() {
            aktif = false;
            ui.style.setProperty('display', 'flex', 'important');
            document.querySelector('h1').innerText = "SKOR: " + score;
            document.getElementById('gaskeun').innerText = "MAIN LAGI";
        }

        // Kontrol Gerak (Mouse & Sentuh)
        function geser(e) {
            let x = e.touches ? e.touches[0].clientX : e.clientX;
            mon.x = x - 40;
        }
        window.addEventListener("mousemove", geser);
        window.addEventListener("touchmove", geser);

    </script>
</body>
</html>
